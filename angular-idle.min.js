/*** Directives and services for responding to idle users in AngularJS
* @author Mike Grabski <me@mikegrabski.com>
* @version v0.3.5
* @link https://github.com/HackedByChinese/ng-idle.git
* @license MIT
*/
!function(a,b){"use strict";function c(){var a={http:null,interval:600};this.http=function(c){if(!c)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");b.isString(c)&&(c={url:c,method:"GET"}),c.cache=!1,a.http=c};var c=this.interval=function(b){if(b=parseInt(b),isNaN(b)||0>=b)throw new Error("Interval must be expressed in seconds and be greater than 0.");a.interval=b};this.$get=["$rootScope","$log","$interval","$http",function(d,e,f,g){function h(a,b){d.$broadcast("$keepaliveResponse",a,b)}function i(){d.$broadcast("$keepalive"),b.isObject(a.http)&&g(a.http).success(h).error(h)}var j={ping:null};return{_options:function(){return a},setInterval:c,start:function(){return f.cancel(j.ping),j.ping=f(i,1e3*a.interval),j.ping},stop:function(){f.cancel(j.ping)},ping:function(){i()}}}]}function d(){var a={idle:1200,timeout:30,autoResume:!0,interrupt:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove",keepalive:!0},c=this.timeout=function(c){if(c===!1)a.timeout=0;else{if(!(b.isNumber(c)&&c>=0))throw new Error("Timeout must be zero or false to disable the feature, or a positive integer (in seconds) to enable it.");a.timeout=c}};this.interrupt=function(b){a.interrupt=b};var d=this.idle=function(b){if(0>=b)throw new Error("Idle must be a value in seconds, greater than 0.");a.idle=b};this.autoResume=function(b){a.autoResume=b===!0},this.keepalive=function(b){a.keepalive=b===!0},this.$get=["$interval","$log","$rootScope","$document","$keepalive",function(b,e,f,g,h){function i(){a.keepalive&&(o.running&&h.ping(),h.start())}function j(){a.keepalive&&h.stop()}function k(){o.idling=!o.idling;var c=o.idling?"Start":"End";f.$broadcast("$idle"+c),o.idling?(j(),a.timeout&&(o.countdown=a.timeout,l(),o.timeout=b(l,1e3,a.timeout,!1))):i(),b.cancel(o.idle)}function l(){return o.countdown<=0?void m():(f.$broadcast("$idleWarn",o.countdown),void o.countdown--)}function m(){j(),b.cancel(o.idle),b.cancel(o.timeout),o.idling=!0,o.running=!1,o.countdown=0,f.$broadcast("$idleTimeout")}function n(a,b,c){var d=a.running();a.unwatch(),b(c),d&&a.watch()}var o={idle:null,timeout:null,idling:!1,running:!1,countdown:null},p={_options:function(){return a},_getNow:function(){return new Date},setIdle:function(a){n(this,d,a)},setTimeout:function(a){n(this,c,a)},isExpired:function(){return o.expiry&&o.expiry<=this._getNow()},running:function(){return o.running},idling:function(){return o.idling},watch:function(){b.cancel(o.idle),b.cancel(o.timeout);var c=a.timeout?a.timeout:0;o.expiry=new Date((new Date).getTime()+1e3*(a.idle+c)),o.idling?k():o.running||i(),o.running=!0,o.idle=b(k,1e3*a.idle,0,!1)},unwatch:function(){b.cancel(o.idle),b.cancel(o.timeout),o.idling=!1,o.running=!1,o.expiry=null},interrupt:function(){return o.running?a.timeout&&this.isExpired()?void m():void(a.autoResume&&this.watch()):void 0}};return g.find("body").on(a.interrupt,function(){p.interrupt()}),p}]}b.module("ngIdle.keepalive",[]).provider("$keepalive",c),b.module("ngIdle.idle",[]).provider("$idle",d),b.module("ngIdle.ngIdleCountdown",[]).directive("ngIdleCountdown",function(){return{restrict:"A",scope:{value:"=ngIdleCountdown"},link:function(a){a.$on("$idleWarn",function(b,c){a.value=c}),a.$on("$idleTimeout",function(){a.value=0})}}}),b.module("ngIdle",["ngIdle.keepalive","ngIdle.idle","ngIdle.ngIdleCountdown"])}(window,window.angular);
//# sourceMappingURL=angular-idle.map